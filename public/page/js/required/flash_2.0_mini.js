window.Flash={DUREE_UTIMER:120,prepared:!1,default_options:{keep:!0,timer:!0,type:"notice"},mess_code:null,expire_time:null,utimer:null,message:function(e,t){return this.show(e,t),!0},error:function(e,t){return"undefined"==typeof t&&(t={}),this.show(e,$.extend(t,{type:"error"})),!1},show:function(e,t){0==this.prepared&&this.prepare(),this.define_all_options(t),this.build_code_message(e),this.append_message()},clean:function(e,t){"undefined"!=typeof t?(this.clear_timers(),$("#flash").fadeOut(null,function(){$(this).html("")})):$("#flash").html("").hide()},define_all_options:function(e){return"undefined"==typeof e?e=$.extend({},this.default_options):(void 0==e.timer&&(e.timer=!0&&this.default_options.timer),void 0==e.keep&&(e.keep=!0&&this.default_options.keep)),this.options=e,e},prepare:function(){0==$("div#flash").length&&$("body").append('<div id="flash"></div>'),this.prepared=!0},append_message:function(){var e=$("#flash");$("#inner_flash").length>0?$("#inner_flash")[this.options.keep?"append":"html"](this.mess_code):e.html('<div id="inner_flash">'+this.mess_code+"</div>"),0==e.is(":visible")&&e.fadeIn(),this.run_required_timer()},build_code_message:function(e){"string"==typeof e&&(e=e.replace(/\\("|')/g,"$1"),this.mess_brut=e,e=e.replace(/\n/g,"<br />"),this.mess_code='<div class="flash '+this.options.type+'">'+e+"</div>")},run_required_timer:function(){this.clear_timers(),this._duree_lecture=null,this[this.options.timer?"run_timer":"run_utimer"]()},clear_timers:function(){this.timer&&(clearTimeout(this.timer),delete this.timer),this.utimer&&(clearTimeout(this.utimer),delete this.utimer),this.expire_time=null},run_utimer:function(){var e=1e3*this.DUREE_UTIMER,t=this.now()+e;(this.expire_time||0)<t&&(this.utimer=setTimeout($.proxy(Flash.clean,Flash,"run_utimer",e),e))},run_timer:function(){null==this.expire_time&&(this.expire_time=this.now()),this.expire_time+=this.duree_lecture();var e=this.expire_time-this.now();this.timer=setTimeout($.proxy(Flash.clean,Flash,"run_timer",e),e)},now:function(){return(new Date).getTime()},duree_lecture:function(){return void 0==this._duree_lecture&&this.calc_duree_lecture_mess(),this._duree_lecture},calc_duree_lecture_mess:function(){this._duree_lecture=parseInt(1e3*this.get_mess_brut().length/6),"error"==this.options.type&&(this._duree_lecture=2*this._duree_lecture)},get_mess_brut:function(){return null==this.mess_brut&&(this.mess_brut="",$("#inner_flash").length&&(this.mess_brut=$("#inner_flash").html().replace(/<([^>]*>)/g,"")),this.options.type=$("div#inner_flash div.error").length?"error":"notice"),this.mess_brut},on_load_page:function(){0!=$("#inner_flash").length&&(this.options={keep:!1,timer:!0,type:null},this.run_required_timer())}},window.F=Flash,Flash.on_load_page();