window.Ajax={url:"./index.rb",onreturn:null,send:function(e){0!=this.before_send(e)&&(e.ajx=1,this.onreturn=e.onreturn,delete e.onreturn,Flash.clean("Ajax.send"),Flash.message("Op\xe9ration en cours\u2026"),$.ajax({url:this.url,type:"POST",data:e,success:$.proxy(this.on_success,this),error:$.proxy(this.on_error,this)}))},on_success:function(e){return Flash.clean("Ajax.on_success"),this.traite_messages_retour(e),this.traite_css_retour(e.css),"function"==typeof this.onreturn&&this.onreturn(e),!0},on_error:function(e,r,n){Flash.clean("Ajax.on_error"),Flash.error(n)},before_send:function(e){var r=void 0==e.r;return r?F.error("Les donn\xe9es envoy\xe9es par Ajax doivent absolument d\xe9finir `r', la m\xe9thode de router \xe0 utliser. Si c'est un champ de formulaire, ajouter le champ hidden de name 'r'."):!0},submit_form:function(e,r){var n;n="string"==typeof e?$("form#"+e):e;var t=hash($(n).serializeArray());t.onreturn=r,this.send(t)},traite_messages_retour:function(e){"undefined"!=typeof e&&("undefined"!=typeof e.message&&(Flash.message(e.message),delete e.message),"undefined"!=typeof e.error&&(Flash.error(e.error),delete e.error))},traite_css_retour:function(e){"undefined"!=typeof e&&null!=e&&$.map(e,function(e){$("head").append("<link rel='stylesheet' type='text/css' href='"+e+"' charset='utf-8' />")})},on_submit_form:function(e){try{var r,n=$(e).serializeArray(),t=hash(n),s=t.r.split("/");r="undefined"==typeof t.onreturn?s:t.onreturn;var o=r[0].capitalize(),a=r[1],i=$.proxy(window[o],a);return t.onreturn=i,this.send(t),!1}catch(u){return F.error("Une erreur est survenue : "+u),!1}}};